<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Resume Analyzer</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        :root {
            --primary-black: #1a1a1a;
            --secondary-black: #2d2d2d;
            --primary-red: #e31837;
            --light-red: #ff1f41;
            --gray-text: #9ca3af;
            --light-gray: #f3f4f6;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--primary-black);
            color: white;
            min-height: 100vh;
            display: flex;
        }

        /* Sidebar Styles */
        .sidebar {
            background: var(--secondary-black);
            width: 250px;
            padding: 25px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-logo {
            margin-bottom: 30px;
        }

        .sidebar-logo img {
            height: 40px;
        }

        .nav-item {
            margin-bottom: 5px;
        }

        .nav-link {
            color: var(--gray-text) !important;
            padding: 12px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }

        .nav-link:hover, .nav-link.active {
            background: rgba(227, 24, 55, 0.1);
            color: var(--primary-red) !important;
        }

        .nav-link i {
            width: 20px;
            margin-right: 10px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 25px;
        }

        /* Profile Section */
        .profile-section {
            background: #2d2d2d;
            border-radius: 12px;
            padding: 20px;
            color: white;
            margin: 20px 0;
        }

        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .profile-image {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin-right: 20px;
        }

        .profile-info h2 {
            margin: 0;
            font-size: 24px;
        }

        .profile-info p {
            margin: 5px 0;
        }

        .education-section {
            margin-top: 20px;
        }

        .education-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .education-dates {
            font-size: 14px;
            color: var(--gray-text);
        }

        .education-place {
            font-size: 14px;
            color: var(--gray-text);
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 28px;
            color: var(--primary-red);
            margin: 0;
        }

        .stat-card p {
            color: var(--gray-text);
            margin: 5px 0 0;
            font-size: 14px;
        }

        .profile-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .content-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
        }

        .content-card h4 {
            color: white;
            margin-bottom: 15px;
            font-size: 18px;
            font-weight: 500;
        }

        .skill-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .skill-tag {
            background: var(--primary-red);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 13px;
        }

        .edit-button {
            background: var(--primary-red);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .edit-button:hover {
            background: var(--light-red);
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            body {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                padding: 15px;
            }

            .profile-header {
                flex-direction: column;
                text-align: center;
            }

            .profile-stats {
                grid-template-columns: 1fr;
            }
        }

        .card {
            border-radius: 15px;
        }

        .card-header {
            background-color: var(--primary-red);
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
        }

        .card-title {
            margin: 0;
        }

        .profile-image {
            border: 2px solid var(--primary-red);
        }

        /* Optional custom styles */
        .profile-info {
            padding: 15px;
        }

        .card {
            border-radius: 15px; /* Rounded corners for the card */
        }

        .card-header {
            background-color: #343a40; /* Dark background for the header */
        }

        .card-body {
            background-color: #2d2d2d; /* Slightly lighter background for the body */
        }

        .btn-secondary {
            position: relative;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background-color: #e31837; /* Red background on hover */
            color: white; /* Ensure text color remains white */
            border-color: #e31837; /* Keep the border color consistent */
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-logo">
            <img src="../static\uploads\logos\Gray_and_Black_Simple_Studio_Logo-removebg-preview.png" alt="Logo">
        </div>
        <ul class="nav flex-column">
            <li class="nav-item">
                <a class="nav-link" href="/applicant_dashboard">
                    <i class="fas fa-home"></i> Dashboard
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" href="/profile">
                    <i class="fas fa-user"></i> Profile
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/applications">
                    <i class="fas fa-file-alt"></i> My Applications
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/saved-jobs">
                    <i class="fas fa-bookmark"></i> Saved Jobs
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/logout">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>
            </li>
        </ul>
       
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="container mt-4">
            <div class="card text-white bg-dark mb-3">
                <div class="card-header" style="background-color: #343a40;">
                    <h5 class="card-title">Profile Information</h5>
                </div>
                <div class="card-body">
                    <div class="profile-info">
                        <h2 class="card-title">{{ applicant.name }}</h2>
                        <p class="card-text"><strong>Email:</strong> {{ applicant.email }}</p>
                        <p class="card-text"><strong>Phone:</strong> {{ applicant.phone }}</p>
                        <p class="card-text"><strong>Experience:</strong> {{ applicant.experience }} years</p>
                        <p class="card-text"><strong>Education:</strong> {{ applicant.education }}</p>
                    </div>
                    <div class="mt-3">
                        <button class="btn btn-secondary" onclick="window.open('{{ applicant.linkedin }}', '_blank')" style="border: 2px solid #e31837; transition: all 0.3s;">
                            LinkedIn
                        </button>
                        <button class="btn btn-secondary" onclick="window.open('{{ applicant.portfolio }}', '_blank')" style="border: 2px solid #e31837; transition: all 0.3s;">
                            Portfolio
                        </button>
                        <button class="btn btn-secondary mt-3" onclick="openEditProfile()" style="border: 2px solid #e31837; transition: all 0.3s;">
                            Edit Profile
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="profile-section">
            <h3>Education</h3>
            <div class="education-section">
                <ul class="list-unstyled">
                    {% for education in applicant.education %}
                    <li class="education-item mb-3">
                        <strong>{{ education.degree }}</strong> at <em>{{ education.institution }}</em> <br>
                        <span class="education-dates">{{ education.year_start }} - {{ education.year_end }}</span> <br>
                        <span class="education-place">{{ education.place }}</span>
                    </li>
                    {% endfor %}
                </ul>
            </div>

            <div class="profile-stats">
                <div class="stat-card">
                    <h3>12</h3>
                    <p>Applications Submitted</p>
                </div>
                <div class="stat-card">
                    <h3>5</h3>
                    <p>Interviews Scheduled</p>
                </div>
                <div class="stat-card">
                    <h3>8</h3>
                    <p>Saved Jobs</p>
                </div>
            </div>

            <div class="profile-content">
                <div class="content-card">
                    <h4>Skills</h4>
                    <div id="skillsContainer">
                        {% for skill in applicant.skills %}
                        <span class="skill-tag">{{ skill }} <button onclick="removeSkill('{{ skill }}')">x</button></span>
                        {% endfor %}
                    </div>
                    <input type="text" id="newSkill" placeholder="Add a new skill">
                    <button onclick="addSkill()">Add Skill</button>
                </div>

                <div class="content-card">
                    <h4>Experience</h4>
                    <div class="experience-item">
                        <h5>Senior Software Engineer</h5>
                        <p>Google</p>
                        <small class="text-muted">2020 - Present</small>
                    </div>
                    <div class="experience-item">
                        <h5>Software Developer</h5>
                        <p>Microsoft</p>
                        <small class="text-muted">2018 - 2020</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div class="modal fade" id="editProfileModal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Profile</h5>
                    <button type="button" class="close" data-dismiss="modal">
                        <span>&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="editProfileForm">
                        <div class="form-group">
                            <label for="headline">Professional Headline</label>
                            <input type="text" class="form-control" id="headline" name="headline" value="{{ applicant.headline }}">
                        </div>
                        <div class="form-group">
                            <label for="location">Location</label>
                            <input type="text" class="form-control" id="location" name="location" value="{{ applicant.location }}">
                        </div>
                        <div class="form-group">
                            <label for="about">About</label>
                            <textarea class="form-control" id="about" name="about" rows="4">{{ applicant.about }}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="linkedin">LinkedIn URL</label>
                            <input type="url" class="form-control" id="linkedin" name="linkedin" value="{{ applicant.linkedin }}">
                        </div>
                        <div class="form-group">
                            <label for="portfolio">Portfolio URL</label>
                            <input type="url" class="form-control" id="portfolio" name="portfolio" value="{{ applicant.portfolio }}">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveProfile()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        async function saveProfile() {
            const form = document.getElementById('editProfileForm');
            const formData = new FormData(form);

            try {
                const response = await fetch('/update_profile', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                if (data.success) {
                    showNotification('Profile updated successfully', 'success');
                    $('#editProfileModal').modal('hide');
                    location.reload();
                } else {
                    showNotification(data.message, 'error');
                }
            } catch (error) {
                console.error('Error updating profile:', error);
                alert('An error occurred while processing your request.');
            }
        }

        async function updateProfileImage(input) {
            if (input.files && input.files[0]) {
                const formData = new FormData();
                formData.append('profile_image', input.files[0]);

                try {
                    const response = await fetch('/update_profile_image', {
                        method: 'POST',
                        body: formData
                    });
                    
                    const data = await response.json();
                    if (data.success) {
                        document.getElementById('profileImage').src = URL.createObjectURL(input.files[0]);
                        showNotification('Profile image updated', 'success');
                    } else {
                        showNotification(data.message, 'error');
                    }
                } catch (error) {
                    showNotification('Error updating profile image', 'error');
                }
            }
        }

        async function removeSkill(skill) {
            if (!confirm('Are you sure you want to remove this skill?')) return;

            try {
                const response = await fetch('/remove_skill', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ skill })
                });
                
                const data = await response.json();
                if (data.success) {
                    showNotification('Skill removed', 'success');
                    location.reload();
                } else {
                    showNotification(data.message, 'error');
                }
            } catch (error) {
                console.error('Error removing skill:', error);
                alert('An error occurred while processing your request.');
            }
        }

        async function addSkill() {
            const newSkill = document.getElementById('newSkill').value;
            if (!newSkill) {
                alert('Please enter a skill.');
                return;
            }

            try {
                const response = await fetch('/add_skill', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ skill: newSkill })
                });
                
                const data = await response.json();
                if (data.success) {
                    showNotification('Skill added', 'success');
                    location.reload();
                } else {
                    showNotification(data.message, 'error');
                }
            } catch (error) {
                console.error('Error adding skill:', error);
                alert('An error occurred while processing your request.');
            }
        }

        function openEditProfile() {
            // Populate the modal fields with the current profile data
            document.getElementById('headline').value = '{{ applicant.headline }}';
            document.getElementById('location').value = '{{ applicant.location }}';
            document.getElementById('about').value = '{{ applicant.about }}';
            document.getElementById('linkedin').value = '{{ applicant.linkedin }}';
            document.getElementById('portfolio').value = '{{ applicant.portfolio }}';

            // Show the modal
            $('#editProfileModal').modal('show');
        }
    </script>
</body>
</html> 